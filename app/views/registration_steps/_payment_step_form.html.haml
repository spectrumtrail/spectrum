= simple_form_for(registration, url: wizard_path, validate: true, html: { id: "PaymentStepForm" }) do |f|
  = f.error_notification
  - if f.object.errors[:base].present?
    = f.error_notification message: f.object.errors[:base].to_sentence
  .form-inputs
    %fieldset
      %h4 Refund Policy
      %div.text-muted.waiver-container
        %span= registration.event.waiver_html.html_safe
      %small.text-danger
        Please scroll to read the entire term set.
        Policies may vary between Events.
      %b
      = f.input :accepts_refund_terms,
        as: :radio_buttons,
        required: true,
        label: "I have read, understood, and accept the refund policy for this Event.",
        input_html: { id: "js-refund-terms-radio-input" }
    %fieldset
      %h4 Payment
      = f.input :billing_email,
        required: true,
        validate: true,
        hint: "Where do you want the receipt to go?",
        input_html: { value: registration.default_billing_email }
      .form-group{class: @card_errors.present? ? "border-danger" : ""}
        %label{for: "card-element"}
          Input Your Card Details
        #card-element
        #card-errors
          - if @card_errors.present?
            = flash[:error]
    %br
    .form-actions
      = f.button :submit,
        "Complete my registration and pay now!",
        id: 'stripe_button',
        class: 'btn btn-md btn-success btn-block',
        disabled: true
    .text-center.text-muted.my-3
      %i.fa.fa-lock.text-success
      %i.fab.fa-stripe
